---
title: "correlation_tests"
author: "Nick Kathios"
date: "4/7/2022"
output: html_document
---

```{r}
library(tidyverse)
library(lme4)
library(lmerTest)
```

#read in data
```{r}
#mpfc-reward/auditory
childhood_mpfc_auditory_reward <- read.table(file='../results/ROI-ROI correlations/childhood_mpfc_auditory_reward_mean.csv')
adolescence_mpfc_auditory_reward <- read.table(file='../results/ROI-ROI correlations/adolescence_mpfc_auditory_reward_mean.csv')
youngadulthood_mpfc_auditory_reward <- read.table(file='../results/ROI-ROI correlations/youngadulthood_mpfc_auditory_reward_mean.csv')
adult_mpfc_auditory_reward <- read.table(file='../results/ROI-ROI correlations/adulthood_mpfc_auditory_reward_mean.csv')


childhood_mpfc_auditory <- read.table(file='../results/ROI-ROI correlations/childhood_mpfc_auditory_mean.csv')
adolescence_mpfc_auditory <- read.table(file='../results/ROI-ROI correlations/adolescence_mpfc_auditory_mean.csv')
youngadulthood_mpfc_auditory <- read.table(file='../results/ROI-ROI correlations/youngadulthood_mpfc_auditory_mean.csv')
adult_mpfc_auditory <- read.table(file='../results/ROI-ROI correlations/adulthood_mpfc_auditory_mean.csv')

childhood_mpfc_reward <- read.table(file='../results/ROI-ROI correlations/childhood_mpfc_reward_mean.csv')
adolescence_mpfc_reward <- read.table(file='../results/ROI-ROI correlations/adolescence_mpfc_reward_mean.csv')
youngadulthood_mpfc_reward <- read.table(file='../results/ROI-ROI correlations/youngadulthood_mpfc_reward_mean.csv')
adult_mpfc_reward <- read.table(file='../results/ROI-ROI correlations/adulthood_mpfc_reward_mean.csv')

childhood_reward <- read.table(file='../results/ROI-ROI correlations/childhood_reward_participant_mean.csv')
adolescence_reward <- read.table(file='../results/ROI-ROI correlations/adolescence_reward_participant_mean.csv')
youngadulthood_reward <- read.table(file='../results/ROI-ROI correlations/youngadulthood_reward_participant_mean.csv')
adult_reward <- read.table(file='../results/ROI-ROI correlations/adulthood_reward_participant_mean.csv')

childhood_mpfc_nac <- read.table(file='../results/ROI-ROI correlations/childhood_mpfc_nac.csv')
adolescence_mpfc_nac <- read.table(file='../results/ROI-ROI correlations/adolescence_mpfc_nac.csv')
youngadulthood_mpfc_nac <- read.table(file='../results/ROI-ROI correlations/youngadulthood_mpfc_nac.csv')
adult_mpfc_nac <- read.table(file='../results/ROI-ROI correlations/adulthood_mpfc_nac.csv')


childhood_mpfc_str<- read.table(file='../results/ROI-ROI correlations/childhood_mpfc_str.csv')
adolescence_mpfc_str <- read.table(file='../results/ROI-ROI correlations/adolescence_mpfc_str.csv')
youngadulthood_mpfc_str <- read.table(file='../results/ROI-ROI correlations/youngadulthood_mpfc_str.csv')
adult_mpfc_str <- read.table(file='../results/ROI-ROI correlations/adulthood_mpfc_str.csv')

childhood_auditory_str<- read.table(file='../results/ROI-ROI correlations/childhood_str_auditory_mean.csv')
adolescence_auditory_str <- read.table(file='../results/ROI-ROI correlations/adolescence_str_auditory_mean.csv')
youngadulthood_auditory_str <- read.table(file='../results/ROI-ROI correlations/youngadulthood_str_auditory_mean.csv')
adult_auditory_str <- read.table(file='../results/ROI-ROI correlations/adulthood_str_auditory_mean.csv')

childhood_auditory_nac<- read.table(file='../results/ROI-ROI correlations/childhood_nac_auditory_mean.csv')
adolescence_auditory_nac <- read.table(file='../results/ROI-ROI correlations/adolescence_nac_auditory_mean.csv')
youngadulthood_auditory_nac <- read.table(file='../results/ROI-ROI correlations/youngadulthood_nac_auditory_mean.csv')
adult_auditory_nac <- read.table(file='../results/ROI-ROI correlations/adulthood_nac_auditory_mean.csv')
```

#cleaning
```{r}
childhood_mpfc_auditory_reward$time <- "Childhood"
childhood_mpfc_auditory_reward$SUBID <- seq(1:25)
adolescence_mpfc_auditory_reward$time <- "Adolescence"
adolescence_mpfc_auditory_reward$SUBID <- seq(1:25)
youngadulthood_mpfc_auditory_reward$time <- "youngadulthood"
youngadulthood_mpfc_auditory_reward$SUBID <- seq(1:25)
adult_mpfc_auditory_reward$time <- "Adulthood"
adult_mpfc_auditory_reward$SUBID <- seq(1:25)

mpfc_auditory_reward <- rbind(childhood_mpfc_auditory_reward, adolescence_mpfc_auditory_reward,youngadulthood_mpfc_auditory_reward,
                              adult_mpfc_auditory_reward)

test <- lmer(V1 ~ time + (1|SUBID), data=mpfc_auditory_reward)
anova(test)

aov <- aov(data=mpfc_auditory_reward, V1 ~ time + Error(SUBID/time))
summary(aov)

childhood_mpfc_auditory$time <- "Childhood"
childhood_mpfc_auditory$SUBID <- seq(1:25)
adolescence_mpfc_auditory$time <- "Adolescence"
adolescence_mpfc_auditory$SUBID <- seq(1:25)
youngadulthood_mpfc_auditory$time <- "youngadulthood"
youngadulthood_mpfc_auditory$SUBID <- seq(1:25)
adult_mpfc_auditory$time <- "Adulthood"
adult_mpfc_auditory$SUBID <- seq(1:25)
mpfc_auditory <- rbind(childhood_mpfc_auditory, adolescence_mpfc_auditory,youngadulthood_mpfc_auditory,
                              adult_mpfc_auditory)

mpfc_auditory$time <- factor(mpfc_auditory$time, levels = c("Childhood", "Adolescence", "youngadulthood", "Adulthood"))

#mpfc_auditory_plot <- 
  ggplot(data=auditory_nac, aes(x=time, y=V1)) +
  stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2) +
  stat_summary(fun.data = 'mean_se', geom = 'pointrange') +
  scale_x_discrete(labels=c("Childhood (0-11)", "Adolescence (12-18)", "Young\nAdulthood (19-25)",
                            "Adulthood (26-45)")) +
  ylab("Average Fisher-Transformed Correlation Coefficient") +
  xlab("Developmental Time Period") +
        theme(
    axis.title.x = element_text(size=18, family="Arial",face="bold"),
    axis.title.y = element_text(size=18, family="Arial", face="bold"),
    axis.text.y = element_text(size=14, family="Arial"), 
    axis.text.x = element_text(size=14, family="Arial"),
    strip.text.x = element_text(size=12,family="Arial")
  ) 

ggsave("../results/mpfc_auditory_plot.png", plot = mpfc_auditory_plot, width=11)

aov <- aov(data=mpfc_auditory, V1 ~ time + Error(SUBID/time))
summary(aov)
test <- lmer(V1 ~ time + (1|SUBID), data=mpfc_auditory)
anova(test)
test.m <- emmeans::emmeans(test, ~time)
A2= c(-1, 3, -1, -1)
emmeans::contrast(test.m, method = list(A2), lmer.df = "satterthwaite")


contrast(test.m, ~time, 'poly') %>%
  broom::tidy()

mpfc_auditory$time <- as.factor(mpfc_auditory$time)

summary(aov, split=list(time=list("Quadratic"=2)))
contrasts(mpfc_auditory$time) <- c(-1, 3, -1, -1)

aov <- aov(data=mpfc_auditory, V1 ~ time + Error(SUBID/time))
aov <- aov(data=mpfc_auditory, V1 ~ time + Error(SUBID/time))
summary(aov)

typeof(mpfc_auditory$time)
childhood_mpfc_reward$time <- "Childhood"
childhood_mpfc_reward$SUBID <- seq(1:25)
adolescence_mpfc_reward$time <- "Adolescence"
adolescence_mpfc_reward$SUBID <- seq(1:25)
youngadulthood_mpfc_reward$time <- "youngadulthood"
youngadulthood_mpfc_reward$SUBID <- seq(1:25)
adult_mpfc_reward$time <- "Adulthood"
adult_mpfc_reward$SUBID <- seq(1:25)
mpfc_reward <- rbind(childhood_mpfc_reward, adolescence_mpfc_reward,youngadulthood_mpfc_reward,
                              adult_mpfc_reward)

aov <- aov(data=mpfc_reward, V1 ~ time + Error(SUBID/time))
summary(aov)

test <- lmer(V1 ~ time + (1|SUBID), data=mpfc_reward)
anova(test)

childhood_reward$time <- "Childhood"
childhood_reward$SUBID <- seq(1:25)
adolescence_reward$time <- "Adolescence"
adolescence_reward$SUBID <- seq(1:25)
youngadulthood_reward$time <- "youngadulthood"
youngadulthood_reward$SUBID <- seq(1:25)
adult_reward$time <- "Adulthood"
adult_reward$SUBID <- seq(1:25)
reward <- rbind(childhood_mpfc_reward, adolescence_mpfc_reward,youngadulthood_mpfc_reward,
                              adult_mpfc_reward)
test <- lmer(V1 ~ time + (1|SUBID), data=reward)
anova(test)


childhood_mpfc_nac$time <- "Childhood"
childhood_mpfc_nac$SUBID <- seq(1:25)
adolescence_mpfc_nac$time <- "Adolescence"
adolescence_mpfc_nac$SUBID <- seq(1:25)
youngadulthood_mpfc_nac$time <- "youngadulthood"
youngadulthood_mpfc_nac$SUBID <- seq(1:25)
adult_mpfc_nac$time <- "Adulthood"
adult_mpfc_nac$SUBID <- seq(1:25)

mpfc_nac <- rbind(childhood_mpfc_nac, adolescence_mpfc_nac,youngadulthood_mpfc_nac,
                              adult_mpfc_nac)

test <- lm(V1 ~ time + (1|SUBID), data=mpfc_nac)
anova(test)

aov <- aov(data=mpfc_nac, V1 ~ time + Error(SUBID/time))
summary(aov)

childhood_mpfc_str$time <- "Childhood"
childhood_mpfc_str$SUBID <- seq(1:25)
adolescence_mpfc_str$time <- "Adolescence"
adolescence_mpfc_str$SUBID <- seq(1:25)
youngadulthood_mpfc_str$time <- "youngadulthood"
youngadulthood_mpfc_str$SUBID <- seq(1:25)
adult_mpfc_str$time <- "Adulthood"
adult_mpfc_str$SUBID <- seq(1:25)

mpfc_str <- rbind(childhood_mpfc_str, adolescence_mpfc_str,youngadulthood_mpfc_str,
                              adult_mpfc_str)

test <- lmer(V1 ~ time + (1|SUBID), data=mpfc_str)
anova(test)

childhood_auditory_str$time <- "Childhood"
childhood_auditory_str$SUBID <- seq(1:25)
adolescence_auditory_str$time <- "Adolescence"
adolescence_auditory_str$SUBID <- seq(1:25)
youngadulthood_auditory_str$time <- "youngadulthood"
youngadulthood_auditory_str$SUBID <- seq(1:25)
adult_auditory_str$time <- "Adulthood"
adult_auditory_str$SUBID <- seq(1:25)

auditory_str <- rbind(childhood_auditory_str, adolescence_auditory_str,youngadulthood_auditory_str,
                              adult_auditory_str)

test <- lmer(V1 ~ time + (1|SUBID), data=auditory_str)
anova(test)

childhood_auditory_nac$time <- "Childhood"
childhood_auditory_nac$SUBID <- seq(1:25)
adolescence_auditory_nac$time <- "Adolescence"
adolescence_auditory_nac$SUBID <- seq(1:25)
youngadulthood_auditory_nac$time <- "youngadulthood"
youngadulthood_auditory_nac$SUBID <- seq(1:25)
adult_auditory_nac$time <- "Adulthood"
adult_auditory_nac$SUBID <- seq(1:25)

auditory_nac <- rbind(childhood_auditory_nac, adolescence_auditory_nac,youngadulthood_auditory_nac,
                              adult_auditory_nac)

test <- lmer(V1 ~ time + (1|SUBID), data=auditory_str)
anova(test)
```
