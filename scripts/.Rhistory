ID = Sys.glob('../data/MRI_mus-bid_task/**********1_mus-bid-biddata.txt')
post_df = ID %>%
map_dfr(read_table, .id = "source")
post_df$source <- as.integer(post_df$source)
source <- seq(1,71,by=1)
ID <- cbind(source,ID)
post_df <- merge(post_df, ID, by.y ="source", by.x="source")
post_df$ID <-  gsub("1_mus-bid-biddata.txt", "", post_df$ID)
post_df$ID <-  gsub("../data/MRI_mus-bid_task/", "", post_df$ID)
names(post_df)<- c("Source", "Stim", "Liking", "Familiarity", "SUBID")
post_df<- subset(post_df, select=c("Stim", "SUBID"))
#use this above code to get GHER matched
post_df$SUBID<-gsub('[[:digit:]]+', '',post_df$SUBID)
#onsets_stim <- merge(post_df, SSAdata, by.x=c("SUBID", "Stim"), by.y=c("SUBID", "stim_number"))
stim_order <- seq(1,24,1)
stim_order <- as.data.frame(rep(stim_order, 60))
TRs<- as.data.frame(seq(1,1440,1))
names(stim_order) <- "order"
names(TRs) <- "TR"
stim_order$order <- arrange(stim_order, order)
TRs <- cbind(stim_order$order, TRs)
TRs_vocalnonvocal<-merge(TRs, SSAdata, by.x="order",by.y="stim_order")
roi_ID <- seq(1,28,1)
roi_ID <- as.data.frame(rep(roi_ID, 1440))
names(roi_ID) <- "ID"
roi_ID <- arrange(roi_ID, ID)
roi_data<-cbind(roi_ID, roidata)
TRs<- (seq(1,1440,1))
TRs_roi<- as.data.frame(rep(TRs, 28))
names(TRs_roi) <- "TR"
roi_data<-cbind(TRs_roi, roi_data)
#merge
roi_dataID<- merge(roi_data, roistim_order, by.x = "ID", by.y="roi_order")
attempt <- merge(TRs_vocalnonvocal, roi_dataID, by.x=c("TR", "SUBID"), by.y=c("TR","SUBID"))
#isolate just music-listening TR
x=1:40320
for (i in x){
if (attempt$TR[i] >= (60*(attempt$order[i]-1)+43) & attempt$TR[i] <= (60*(attempt$order[i]-1)+60)){
attempt$TR[i] = NA
}
}
attempt<-attempt[!is.na(attempt$TR),]
#attempt<-subset(attempt, Stim < 17)
roi_timeseries <- write.csv(attempt, file="auditoryreward.csv")
library(tidyverse)
library(lmerTest)
library(lme4)
timeseries <- read.csv(file='auditoryreward.csv')
timeseries$seconds<- (timeseries$TR - ((timeseries$order-1)*60))*0.475 # adding seconds to df
timeseries$age_bin = ifelse(timeseries$age_bin=="aduthood","adulthood", timeseries$age_bin) #recoding some values
timeseries <- timeseries[!(is.na(timeseries$age_bin) | timeseries$age_bin==""), ]
key <- read.csv(file="participant_key.csv")
timeseries <- merge(timeseries,key)
timeseries$cognitive_health = ifelse(timeseries$cognitive_health=="Healthy","Cognitively Healthy", timeseries$cognitive_health) #recoding some values
timeseries$age_bin = ifelse(timeseries$age_bin=="adulthood","Adulthood", timeseries$age_bin) #recoding some values
timeseries$age_bin = ifelse(timeseries$age_bin=="adolescence","Adolescence", timeseries$age_bin) #recoding some values
timeseries$age_bin = ifelse(timeseries$age_bin=="childhood","Childhood", timeseries$age_bin) #recoding some values
timeseries$age_bin<-factor(timeseries$age_bin, levels = c("Childhood", "Adolescence", "Adulthood"))
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_valuel = mPFC_cluster
)
View(onset_value)
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = mPFC_cluster
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[45])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = (mPFC_cluster - onset_value)/sd(mPFC_cluster), #update ROIs here
)
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
#  facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
View(timeseries_onset_value)
ggplot(timeseries_onset_value, aes(x=round(seconds), y=mPFC_cluster)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
#  facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=mPFC_cluster)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=SUBID, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=mPFC_cluster)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=mPFC_cluster)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
#facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=mPFC)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
#facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggplot(timeseries_onset_value, aes(x=round(seconds), y=mPFC)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
# theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = mPFC #update ROIs here
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[44])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = ((mPFC - onset_value)/sd(mPFC)) #update ROIs here
)
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = mPFC #update ROIs here
)
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = mPFC #update ROIs here
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[45])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = ((mPFC - onset_value)/sd(mPFC)) #update ROIs here
)
average_activation <-
timeseries_onset_value %>%
group_by(SUBID, stim_number, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(scaled), list(name = mean)) ##if you want to look at different ROIs, update the variable in the "vars()" argument to whichever column ROI you want
names(average_activation)[5] = "average" #renaming the output of previous function
##plotting
ggplot(data=average_activation, aes(x=age_bin, y=average))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
average_activation <-
timeseries %>%
group_by(SUBID, stim_number, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(scaled), list(name = mean)) ##if you want to look at different ROIs, update the variable in the "vars()" argument to whichever column ROI you want
average_activation <-
timeseries %>%
group_by(SUBID, stim_number, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mPFC), list(name = mean)) ##if you want to look at different ROIs, update the variable in the "vars()" argument to whichever column ROI you want
names(average_activation)[5] = "average" #renaming the output of previous function
##plotting
ggplot(data=average_activation, aes(x=age_bin, y=average))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
average_activation <-
timeseries %>%
group_by(SUBID, stim_number, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(accumbensl), list(name = mean)) ##if you want to look at different ROIs, update the variable in the "vars()" argument to whichever column ROI you want
names(average_activation)[5] = "average" #renaming the output of previous function
##plotting
ggplot(data=average_activation, aes(x=age_bin, y=average))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
average_activation <-
timeseries %>%
group_by(SUBID, stim_number, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(accumbensr), list(name = mean)) ##if you want to look at different ROIs, update the variable in the "vars()" argument to whichever column ROI you want
##plotting
ggplot(data=average_activation, aes(x=age_bin, y=average))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
names(average_activation)[5] = "average" #renaming the output of previous function
##plotting
ggplot(data=average_activation, aes(x=age_bin, y=average))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mPFC_cluster), list(name = mean))
View(participant_average_activation)
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
View(timeseries_all)
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mean_response - timeseries_all$mPFC_cluster
##plotting
ggplot(data=timeseries_all, aes(x=age_bin, y=mean_centered))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
##plotting
ggplot(data=timeseries_all, aes(x=age_bin, y=mean_centered))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
View(participant_average_activation)
View(participant_average_meancenter)
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mPFC), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(accumbensl), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(accumbensr), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mPFC_cluster), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(hippocampusl), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(hippocampusr), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(AC), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(PC), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(caudatel), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(caudater), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
participant_average_activation <-
timeseries %>%
group_by(SUBID) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mPFC_cluster), list(name = mean))
timeseries_all <- merge(timeseries, participant_average_activation, by = "SUBID", all.x=TRUE )
names(timeseries_all)[45] <- "mean_response"
timeseries_all$mean_centered <- timeseries_all$mPFC_cluster - timeseries_all$mean_response
participant_average_meancenter <-
timeseries_all %>%
group_by(SUBID, age_bin,cognitive_health) %>% ## here you can add which variables you'd be interested in looking at
summarise_at(vars(mean_centered), list(name = mean))
##plotting
ggplot(data=participant_average_meancenter, aes(x=age_bin, y=name))+
theme_classic() +
stat_summary(fun.data = 'mean_cl_normal', geom = 'errorbar', width = 0.2, alpha=0.5) +
stat_summary(fun.data = 'mean_cl_normal', geom = 'pointrange', alpha=0.5) +
facet_grid(~cognitive_health)
