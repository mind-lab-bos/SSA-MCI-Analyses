timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = (HCl - onset_value)/sd(HCl), #update ROIs here
)
#NAccltimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggsave(HCltimeseries, file="HCltimeseries", dpi=350, width=12)
HCltimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggsave(HCltimeseries, file="HCltimeseries", dpi=350, width=12)
ggsave(HCltimeseries, file="HCltimeseries.png", dpi=350, width=12)
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = accumbensl
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[42])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = (accumbensl - onset_value)/sd(accumbensl), #update ROIs here
)
#HCltimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = accumbensr
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[42])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = (accumbensr - onset_value)/sd(accumbensr), #update ROIs here
)
#HCltimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = mPFC
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[42])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = (mPFC - onset_value)/sd(mPFC), #update ROIs here
)
#HCltimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_value = HCr
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[42])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaled = (HCr - onset_value)/sd(HCr), #update ROIs here
)
#HCltimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=scaled)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
View(timeseries)
##all together
timeseries$HCaverage <- (timeseries$HCl + timeseries$HCr)/2
onset_value <-
timeseries %>%
group_by(SUBID, stim_number) %>%
subset(seconds==0.475) %>%
mutate(
onset_valuel = HCl, #update ROIs here
onset_valuer = HCr
)
onset_value <- cbind(onset_value[1],onset_value[6],onset_value[43], onset_value[44])
timeseries_onset_value <- merge(timeseries, onset_value, by.x=c("SUBID","stim_number"), by.y=c("SUBID", "stim_number"))
timeseries_onset_value <-
timeseries_onset_value %>%
group_by(SUBID, stim_number) %>%
mutate(
scaledl = (HCl - onset_valuel)/sd(HCl), #update ROIs here,
scaledr = (HCr - onset_valuer)/sd(HCr)
)
timeseries_onset_value$NAccaverage <- (timeseries_onset_value$scaledl + timeseries_onset_value$scaledr)/2
#NAccaveragetimeseries <-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=NAccaverage)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
HCaveragetimeseries<-
ggplot(timeseries_onset_value, aes(x=round(seconds), y=NAccaverage)) +
geom_smooth(aes(color=age_bin, fill=age_bin))+
theme_classic()+
labs(x= "Time (s)", y="Scaled ROI Activity") +
facet_grid(~cognitive_health) +
scale_color_discrete(name = "Age of Exposure")+
scale_fill_discrete(name = "Age of Exposure") +
theme(legend.position = "none") +
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"))
ggsave(HCaveragetimeseries, file="HCaveragetimeseries.png", dpi=350, width=12)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(emmeans)
caudate <- read.csv(file='../data/bilateralcaudate_mpfc_connectivity.csv')
caudate <- caudate %>%
pivot_longer(Childhood:Adulthood, names_to = "Time_Period", values_to = "Connectivity")
caudate$brain_region <- "Caudate"
count <- read.csv(file='../data/mpfc_voxel_count.csv')
hippocampus <- read.csv(file='../data/bilateralhippocampus_mpfc_connectivity.csv')
hippocampus <- hippocampus %>%
pivot_longer(Childhood:Adulthood, names_to = "Time Period", values_to = "Connectivity")
auditory <- read.csv(file='../data/auditory_mpfc_connectivity.csv')
auditory <- auditory %>%
pivot_longer(Childhood:Adulthood, names_to = "Time Period", values_to = "Connectivity")
library(tidyverse)
library(corrplot)
library(emmeans)
library(ggsignif)
childhood <- read.csv(file='childhoodconnectivity.csv')
adolescence <- read.csv(file='adolescentconnectivity.csv')
adulthood <- read.csv(file='adulthoodconnectivity.csv')
childhood <- read.csv(file='childhoodconnectivity.csv')
adolescence <- read.csv(file='adolescentconnectivity.csv')
adulthood <- read.csv(file='adulthoodconnectivity.csv')
View(adolescence)
rownames(childhood) <- childhood$X
childhood$X <- NULL
childhood <- data.matrix(childhood)
childhood[is.na(childhood)] <-1
childhood <- DescTools::FisherZInv(childhood)
png(height=1800, width=1800, file="../childhood_correlations.png")
corrplot(childhood, tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200), tl.pos='n', col.lim = c(-1,1), type="upper", method="color",  cl.cex = 3.5)
png(height=1800, width=1800, file="../childhood_correlations.png")
corrplot(childhood, tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200), tl.pos='n', col.lim = c(-1,1), type="upper", method="color",  cl.cex = 3.5)
dev.off()
rownames(adolescence) <- adolescence$X
adolescence$X <- NULL
adolescence <- data.matrix(adolescence)
adolescence[is.na(adolescence)] <- 1
adolescence <- DescTools::FisherZInv(adolescence)
png(height=1800, width=1800, file="../adolescence_correlations.png")
corrplot(adolescence, tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200), tl.pos='n', col.lim = c(-1,1), type="upper", method="color", cl.cex = 3.5)
dev.off()
rownames(adulthood) <- adulthood$X
adulthood$X <- NULL
adulthood <- data.matrix(adulthood)
adulthood[is.na(adulthood)] <- 1
adulthood <- DescTools::FisherZInv(adulthood)
png(height=1800, width=1800, file="../adulthood_correlations.png")
corrplot(adulthood, type="upper", tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200),tl.pos='n', col.lim = c(-1,1), cl.cex = 3.5,method="color")
dev.off()
View(adolescence)
childhood <- read.csv(file='childhoodconnectivity.csv')
adolescence <- read.csv(file='adolescentconnectivity.csv')
adulthood <- read.csv(file='adulthoodconnectivity.csv')
childhood_mpfc_auditory <- read.table(file='childhood_mpfc_auditory_mean.csv')
View(childhood_mpfc_auditory)
library(tidyverse)
library(corrplot)
library(emmeans)
library(ggsignif)
childhood <- read.csv(file='childhoodconnectivity.csv')
adolescence <- read.csv(file='adolescentconnectivity.csv')
adulthood <- read.csv(file='adulthoodconnectivity.csv')
rownames(childhood) <- childhood$X
childhood$X <- NULL
childhood <- data.matrix(childhood)
childhood[is.na(childhood)] <-1
childhood <- DescTools::FisherZInv(childhood)
png(height=1800, width=1800, file="../childhood_correlations.png")
corrplot(childhood, tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200), tl.pos='n', col.lim = c(-1,1), type="upper", method="color",  cl.cex = 3.5)
dev.off()
rownames(adolescence) <- adolescence$X
adolescence$X <- NULL
adolescence <- data.matrix(adolescence)
adolescence[is.na(adolescence)] <- 1
adolescence <- DescTools::FisherZInv(adolescence)
png(height=1800, width=1800, file="../adolescence_correlations.png")
corrplot(adolescence, tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200), tl.pos='n', col.lim = c(-1,1), type="upper", method="color", cl.cex = 3.5)
dev.off()
rownames(adulthood) <- adulthood$X
adulthood$X <- NULL
adulthood <- data.matrix(adulthood)
adulthood[is.na(adulthood)] <- 1
adulthood <- DescTools::FisherZInv(adulthood)
png(height=1800, width=1800, file="../adulthood_correlations.png")
corrplot(adulthood, type="upper", tl.col = "black", col=colorRampPalette(c("blue","white","red"))(200),tl.pos='n', col.lim = c(-1,1), cl.cex = 3.5,method="color")
dev.off()
library(tidyverse)
library(lme4)
library(lmerTest)
childhood_mpfc_auditory <- read.table(file='childhood_mpfc_auditory_mean.csv')
adolescence_mpfc_auditory <- read.table(file='adolescence_mpfc_auditory_mean.csv')
adult_mpfc_auditory <- read.table(file='adulthood_mpfc_auditory_mean.csv')
childhood_mpfc_reward <- read.table(file='childhood_mpfc_reward_mean.csv')
adolescence_mpfc_reward <- read.table(file='adolescence_mpfc_reward_mean.csv')
adult_mpfc_reward <- read.table(file='adulthood_mpfc_reward_mean.csv')
childhood_reward_auditory <- read.table(file='childhood_reward_auditory_mean.csv')
adolescence_reward_auditory <- read.table(file='adolescence_reward_auditory_mean.csv')
adult_reward_auditory <- read.table(file='adulthood_reward_auditory_mean.csv')
childhood_auditory <- read.table(file='childhood_auditory_participant_mean.csv')
adolescence_auditory <- read.table(file='adolescence_auditory_participant_mean.csv')
adult_auditory <- read.table(file='adulthood_auditory_participant_mean.csv')
childhood_reward <- read.table(file='childhood_reward_participant_mean.csv')
adolescence_reward <- read.table(file='adolescence_reward_participant_mean.csv')
adult_reward <- read.table(file='adulthood_reward_participant_mean.csv')
key <- read.csv(file="participant_key.csv")
key$cognitive_health = ifelse(key$cognitive_health=="Healthy","Cognitively Healthy", key$cognitive_health) #recoding some values
#MPFC - AUDITORY
childhood_mpfc_auditory$time <- "Childhood"
childhood_mpfc_auditory$CONN_ID <- seq(1:30)
childhood_mpfc_auditory$CONN_ID <- seq(1:35)
adolescence_mpfc_auditory$time <- "Adolescence"
adolescence_mpfc_auditory$CONN_ID <- seq(1:35)
adult_mpfc_auditory$time <- "Adulthood"
adult_mpfc_auditory$CONN_ID <- seq(1:35)
mpfc_auditory <- rbind(childhood_mpfc_auditory, adolescence_mpfc_auditory,
adult_mpfc_auditory)
mpfc_auditory <- merge(mpfc_auditory, key, by = "CONN_ID")
mpfc_auditory$time <- factor(mpfc_auditory$time, levels = c("Childhood", "Adolescence", "Adulthood"))
ggplot(data=mpfc_auditory, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange') +
scale_x_discrete(labels=c("Childhood (0-12)", "Adolescence (13-18)",
"Adulthood (26-45)")) +
ylab("Average Fisher-Transformed Correlation Coefficient") +
xlab("Developmental Time Period")+
facet_grid(~cognitive_health)
aov <- aov(data=mpfc_auditory, V1 ~ time + Error(SUBID/time))
summary(aov)
test <- lmer(V1 ~ time + (1|SUBID), data=mpfc_auditory)
anova(test)
test.m <- emmeans::emmeans(test, ~time)
A2= c(-1, 3, -1, -1)
emmeans::contrast(test.m, method = list(A2), lmer.df = "satterthwaite")
A2= c(-1, 2, -1)
emmeans::contrast(test.m, method = list(A2), lmer.df = "satterthwaite")
contrast(test.m, ~time, 'poly') %>%
broom::tidy()
mpfc_auditory$time <- as.factor(mpfc_auditory$time)
summary(aov, split=list(time=list("Quadratic"=2)))
#MPFC - REWARD (HIGHLIGHT!!)
childhood_mpfc_reward$time <- "Childhood"
childhood_mpfc_reward$CONN_ID <- seq(1:35)
adolescence_mpfc_reward$time <- "Adolescence"
adolescence_mpfc_reward$CONN_ID <- seq(1:35)
adult_mpfc_reward$time <- "Adulthood"
adult_mpfc_reward$CONN_ID <- seq(1:35)
mpfc_reward <- rbind(childhood_mpfc_reward, adolescence_mpfc_reward,
adult_mpfc_reward)
mpfc_reward <- merge(mpfc_reward, key, by = "CONN_ID")
#mpfc_rewardplot<-
ggplot(data=mpfc_reward, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2, aes(color=time)) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange', aes(color=time)) +
scale_x_discrete(labels=c("Childhood\n(0-12)", "Adolescence\n(13-18)",
"Adulthood\n(26-45)")) +
ylab("Average Fisher-Transformed\nCorrelation Coefficient") +
xlab("Developmental Time Period")  +
facet_grid(~cognitive_health) +
theme_classic()+
theme(legend.position = "none") +
xlab("Age of Exposure")+
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"), title = element_text(size=22, face="bold")) +
ggtitle("Average mPFC-Reward Network Connectivity")
#REWARD-REWARD -- HIGHLIGHT MCI?
childhood_reward$time <- "Childhood"
childhood_reward$CONN_ID <- seq(1:35)
adolescence_reward$time <- "Adolescence"
adolescence_reward$CONN_ID <- seq(1:35)
adult_reward$time <- "Adulthood"
adult_reward$CONN_ID <- seq(1:35)
reward <- rbind(childhood_reward, adolescence_reward,
adult_reward)
reward <- merge(reward, key, by = "CONN_ID")
test <- lmer(V1 ~ time + (1|SUBID), data=reward)
anova(test)
ggplot(data=reward, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange') +
scale_x_discrete(labels=c("Childhood (0-12)", "Adolescence (13-18)",
"Adulthood (26-45)")) +
ylab("Average Fisher-Transformed Correlation Coefficient") +
xlab("Developmental Time Period") +
theme(
axis.title.x = element_text(size=18, family="Arial",face="bold"),
axis.title.y = element_text(size=18, family="Arial", face="bold"),
axis.text.y = element_text(size=14, family="Arial"),
axis.text.x = element_text(size=14, family="Arial"),
strip.text.x = element_text(size=12,family="Arial")
) +
facet_grid(~cognitive_health)
childhood_reward_auditory$CONN_ID <- seq(1:35)
adolescence_reward_auditory$time <- "Adolescence"
adolescence_reward_auditory$CONN_ID <- seq(1:30)
adolescence_reward_auditory$CONN_ID <- seq(1:35)
adult_reward_auditory$time <- "Adulthood"
adult_reward_auditory$CONN_ID <- seq(1:35)
reward_auditory <- rbind(childhood_reward_auditory, adolescence_reward_auditory,
adult_reward_auditory)
childhood_reward_auditory$time <- "Childhood"
childhood_reward_auditory$CONN_ID <- seq(1:35)
adolescence_reward_auditory$time <- "Adolescence"
adolescence_reward_auditory$CONN_ID <- seq(1:35)
adult_reward_auditory$time <- "Adulthood"
adult_reward_auditory$CONN_ID <- seq(1:35)
reward_auditory <- rbind(childhood_reward_auditory, adolescence_reward_auditory,
adult_reward_auditory)
reward_auditory <- merge(reward_auditory, key, by = "CONN_ID")
test <- lmer(V1 ~ time + (1|SUBID), data=reward_auditory)
anova(test)
reward_auditory<-
ggplot(data=reward_auditory, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2, aes(color=time)) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange',aes(color=time)) +
scale_x_discrete(labels=c("Childhood\n(0-12)", "Adolescence\n(13-18)",
"Adulthood\n(26-45)")) +
ylab("Average Fisher-Transformed\nCorrelation Coefficient") +
xlab("Developmental Time Period") +
facet_grid(~cognitive_health) +
theme_classic()+
theme(legend.position = "none") +
xlab("Age of Exposure")+
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"), title = element_text(size=22, face="bold")) +
ggtitle("Average Auditory-Reward Network Connectivity")
#reward_auditory<-
ggplot(data=reward_auditory, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2, aes(color=time)) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange',aes(color=time)) +
scale_x_discrete(labels=c("Childhood\n(0-12)", "Adolescence\n(13-18)",
"Adulthood\n(26-45)")) +
ylab("Average Fisher-Transformed\nCorrelation Coefficient") +
xlab("Developmental Time Period") +
facet_grid(~cognitive_health) +
theme_classic()+
theme(legend.position = "none") +
xlab("Age of Exposure")+
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"), title = element_text(size=22, face="bold")) +
ggtitle("Average Auditory-Reward Network Connectivity")
#reward_auditory<-
ggplot(data=reward_auditory, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2, aes(color=time)) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange',aes(color=time)) +
scale_x_discrete(labels=c("Childhood\n(0-12)", "Adolescence\n(13-18)",
"Adulthood\n(26-45)")) +
ylab("Average Fisher-Transformed\nCorrelation Coefficient") +
xlab("Developmental Time Period") +
facet_grid(~cognitive_health) +
theme_classic()+
theme(legend.position = "none") +
xlab("Age of Exposure")+
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"), title = element_text(size=22, face="bold")) +
ggtitle("Average Auditory-Reward Network Connectivity")
reward_auditory <- rbind(childhood_reward_auditory, adolescence_reward_auditory,
adult_reward_auditory)
reward_auditory <- merge(reward_auditory, key, by = "CONN_ID")
test <- lmer(V1 ~ time + (1|SUBID), data=reward_auditory)
anova(test)
#reward_auditory<-
ggplot(data=reward_auditory, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2, aes(color=time)) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange',aes(color=time)) +
scale_x_discrete(labels=c("Childhood\n(0-12)", "Adolescence\n(13-18)",
"Adulthood\n(26-45)")) +
ylab("Average Fisher-Transformed\nCorrelation Coefficient") +
xlab("Developmental Time Period") +
facet_grid(~cognitive_health) +
theme_classic()+
theme(legend.position = "none") +
xlab("Age of Exposure")+
theme(axis.text=element_text(size=20, face="bold"), axis.title=element_text(size=20,face="bold"), strip.text.x = element_text(size=18,face="bold"), title = element_text(size=22, face="bold")) +
ggtitle("Average Auditory-Reward Network Connectivity")
#AUDITORY - AUDITORY
childhood_auditory$time <- "Childhood"
childhood_auditory$CONN_ID <- seq(1:35)
adolescence_auditory$time <- "Adolescence"
adolescence_auditory$CONN_ID <- seq(1:35)
adult_auditory$time <- "Adulthood"
adult_auditory$CONN_ID <- seq(1:35)
auditory <- rbind(childhood_auditory, adolescence_auditory,
adult_auditory)
auditory <- merge(auditory, key, by = "CONN_ID")
test <- lmer(V1 ~ time + (1|SUBID), data=auditory)
anova(test)
ggplot(data=auditory, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange') +
scale_x_discrete(labels=c("Childhood (0-12)", "Adolescence (13-18)",
"Adulthood (26-45)")) +
ylab("Average Fisher-Transformed Correlation Coefficient") +
xlab("Developmental Time Period") +
theme(
axis.title.x = element_text(size=18, family="Arial",face="bold"),
axis.title.y = element_text(size=18, family="Arial", face="bold"),
axis.text.y = element_text(size=14, family="Arial"),
axis.text.x = element_text(size=14, family="Arial"),
strip.text.x = element_text(size=12,family="Arial")
) +
facet_grid(~cognitive_health)
childhood <- read.csv(file='childhoodconnectivity.csv')
library(tidyverse)
library(lme4)
library(lmerTest)
childhood_mpfc_auditory <- read.table(file='childhood_mpfc_auditory_mean.csv')
adolescence_mpfc_auditory <- read.table(file='adolescence_mpfc_auditory_mean.csv')
adult_mpfc_auditory <- read.table(file='adulthood_mpfc_auditory_mean.csv')
childhood_mpfc_reward <- read.table(file='childhood_mpfc_reward_mean.csv')
adolescence_mpfc_reward <- read.table(file='adolescence_mpfc_reward_mean.csv')
adult_mpfc_reward <- read.table(file='adulthood_mpfc_reward_mean.csv')
childhood_reward_auditory <- read.table(file='childhood_reward_auditory_mean.csv')
adolescence_reward_auditory <- read.table(file='adolescence_reward_auditory_mean.csv')
adult_reward_auditory <- read.table(file='adulthood_reward_auditory_mean.csv')
childhood_auditory <- read.table(file='childhood_auditory_participant_mean.csv')
adolescence_auditory <- read.table(file='adolescence_auditory_participant_mean.csv')
adult_auditory <- read.table(file='adulthood_auditory_participant_mean.csv')
childhood_reward <- read.table(file='childhood_reward_participant_mean.csv')
adolescence_reward <- read.table(file='adolescence_reward_participant_mean.csv')
adult_reward <- read.table(file='adulthood_reward_participant_mean.csv')
childhood_hc_nac <- read.table(file='childhood_hc_nac_mean.csv')
adolescence_hc_nac <- read.table(file='adolescence_hc_nac_mean.csv')
adulthood_hc_nac <- read.table(file='adulthood_hc_nac_mean.csv')
key <- read.csv(file="participant_key.csv")
key$cognitive_health = ifelse(key$cognitive_health=="Healthy","Cognitively Healthy", key$cognitive_health) #recoding some values
childhood_hc_nac$time <- "Childhood"
childhood_hc_nac$CONN_ID <- seq(1:35)
adolescence_hc_nac$time <- "Adolescence"
adolescence_hc_nac$CONN_ID <- seq(1:35)
adulthood_hc_nac$time <- "Adulthood"
adulthood_hc_nac$CONN_ID <- seq(1:35)
nac_hc <- rbind(childhood_hc_nac, adolescence_hc_nac,
adulthood_hc_nac)
nac_hc <- merge(nac_hc, key, by = "CONN_ID")
nac_hc$time <- factor(nac_hc$time, levels = c("Childhood", "Adolescence", "Adulthood"))
ggplot(data=nac_hc, aes(x=time, y=V1)) +
stat_summary(fun.data = 'mean_se', geom = 'errorbar', width = 0.2) +
stat_summary(fun.data = 'mean_se', geom = 'pointrange') +
scale_x_discrete(labels=c("Childhood (0-12)", "Adolescence (13-18)",
"Adulthood (26-45)")) +
ylab("Average Fisher-Transformed Correlation Coefficient") +
xlab("Developmental Time Period")+
facet_grid(~cognitive_health)
